{
  "title": "Retrieval-augmented generation with Pinecone",
  "description": "This board implements the simples possible retrieval-augmented generation system using Pinecone store. The store was generated with [pinecone-load](https://github.com/google/labs-prototypes/blob/main/seeds/graph-playground/graphs/pinecone-load.json).",
  "version": "0.0.1",
  "edges": [
    {
      "from": "secrets-1",
      "to": "make-headers",
      "out": "PINECONE_API_KEY",
      "in": "json"
    },
    {
      "from": "make-headers",
      "to": "pinecone-upsert-api",
      "out": "result",
      "in": "headers"
    },
    {
      "from": "secrets-2",
      "to": "make-pinecone-url",
      "out": "PINECONE_URL",
      "in": "PINECONE_URL"
    },
    {
      "from": "make-pinecone-url",
      "to": "pinecone-upsert-api",
      "out": "prompt",
      "in": "url"
    },
    {
      "from": "secrets-5",
      "to": "embedString-4",
      "out": "PALM_KEY",
      "in": "PALM_KEY"
    },
    {
      "from": "jsonata-6",
      "to": "promptTemplate-3",
      "out": "result",
      "in": "context"
    },
    {
      "from": "pinecone-upsert-api",
      "to": "jsonata-6",
      "out": "response",
      "in": "json"
    },
    {
      "from": "make-body",
      "to": "pinecone-upsert-api",
      "out": "result",
      "in": "body"
    },
    {
      "from": "embedString-4",
      "to": "make-body",
      "out": "embedding",
      "in": "json"
    },
    {
      "from": "query",
      "to": "embedString-4",
      "out": "text",
      "in": "text"
    },
    {
      "from": "query",
      "to": "promptTemplate-3",
      "out": "text",
      "in": "query"
    },
    {
      "from": "secrets-8",
      "to": "generateText-7",
      "out": "PALM_KEY",
      "in": "PALM_KEY"
    },
    {
      "from": "generateText-7",
      "to": "output-9",
      "out": "completion",
      "in": "text"
    },
    {
      "from": "promptTemplate-3",
      "to": "generateText-7",
      "out": "prompt",
      "in": "text"
    }
  ],
  "nodes": [
    {
      "id": "make-headers",
      "type": "jsonata",
      "configuration": {
        "expression": "{ \"Api-Key\": $, \"Accept\": \"application/json\", \"Content-Type\": \"application/json\" }"
      }
    },
    {
      "id": "secrets-1",
      "type": "secrets",
      "configuration": {
        "keys": [
          "PINECONE_API_KEY"
        ]
      }
    },
    {
      "id": "pinecone-upsert-api",
      "type": "fetch",
      "configuration": {
        "raw": false,
        "method": "POST"
      }
    },
    {
      "id": "make-pinecone-url",
      "type": "promptTemplate",
      "configuration": {
        "template": "{{PINECONE_URL}}/query"
      }
    },
    {
      "id": "secrets-2",
      "type": "secrets",
      "configuration": {
        "keys": [
          "PINECONE_URL"
        ]
      }
    },
    {
      "id": "make-body",
      "type": "jsonata",
      "configuration": {
        "expression": "{ \"vector\": $, \"topK\": 10, \"includeMetadata\": true }"
      }
    },
    {
      "id": "promptTemplate-3",
      "type": "promptTemplate",
      "configuration": {
        "template": "You are a helpful and informative bot that answers questions using text from the knowledge base below.\n\nAnalyze the question and the knowledge base and produce a comprehensive summary that answers the question using only the information from the knowledge base.\n\nIf the knowledge base does not contain the answer, tell the user that you do not possess this information and direct the user to Google search.\n\n\n# Question:\n\n{{query}}\n\n# Knowledge Base:\n{{context}}\n\n\n# Answer\n"
      }
    },
    {
      "id": "query",
      "type": "input"
    },
    {
      "id": "embedString-4",
      "type": "embedString"
    },
    {
      "id": "secrets-5",
      "type": "secrets",
      "configuration": {
        "keys": [
          "PALM_KEY"
        ]
      }
    },
    {
      "id": "jsonata-6",
      "type": "jsonata",
      "configuration": {
        "expression": "$join(matches.metadata.text, '\n\n')"
      }
    },
    {
      "id": "generateText-7",
      "type": "generateText"
    },
    {
      "id": "secrets-8",
      "type": "secrets",
      "configuration": {
        "keys": [
          "PALM_KEY"
        ]
      }
    },
    {
      "id": "output-9",
      "type": "output"
    }
  ],
  "kits": [
    {
      "url": "npm:@google-labs/llm-starter"
    },
    {
      "url": "npm:@google-labs/node-nursery"
    }
  ]
}